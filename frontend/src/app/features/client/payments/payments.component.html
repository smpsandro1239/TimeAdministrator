<div class="payments-container">
  <h2>Meus Pagamentos</h2>
  <p>Veja o histórico dos seus pagamentos.</p>

  <!-- Estado de Carregamento -->
  <div class="loading-container" *ngIf="loading">
    <mat-spinner></mat-spinner>
    <p>A carregar o seu histórico de pagamentos...</p>
  </div>

  <!-- Lista de Pagamentos -->
  <div class="payments-list" *ngIf="!loading && payments.length > 0">
    <mat-card class="payment-card" *ngFor="let payment of payments; let i = index">
      <mat-card-header>
        <mat-card-title>Pagamento #{{ payments.length - i }}</mat-card-title>
        <mat-card-subtitle>
          Subscrição {{ periodLabels[payment.subscriptionPeriod] }}
        </mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div class="payment-details">
          <p><strong>Valor:</strong> {{ payment.amount | currency:'EUR' }}</p>
          <p><strong>Data:</strong> {{ payment.paidAt || payment.createdAt | date:'dd/MM/yyyy' }}</p>
          <p><strong>Método:</strong> {{ payment.method | titlecase }}</p>
          <p>
            <strong>Estado:</strong>
            <mat-chip [color]="getStatusColor(payment.status)" selected>{{ payment.status | titlecase }}</mat-chip>
          </p>
        </div>
      </mat-card-content>
      <mat-card-actions>
        <a mat-button color="primary" [href]="payment.receiptUrl" target="_blank" [disabled]="!payment.receiptUrl">
          <mat-icon>receipt_long</mat-icon>
          Ver Recibo
        </a>
      </mat-card-actions>
    </mat-card>
  </div>

  <!-- Estado de Ausência de Pagamentos -->
  <div class="no-payments" *ngIf="!loading && payments.length === 0">
    <mat-icon class="large-icon">history_toggle_off</mat-icon>
    <h3>Ainda não tem pagamentos</h3>
    <p>O seu histórico de pagamentos aparecerá aqui assim que realizar o primeiro.</p>
  </div>
</div>
